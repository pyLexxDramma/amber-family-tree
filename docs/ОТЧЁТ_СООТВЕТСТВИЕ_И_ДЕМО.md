# Краткий отчёт: соответствие брифу, экранам ТЗ и режимы демо

**Дата:** 18 февраля 2026  
**Прототип:** Angelo (Amber Family Tree)  
**Деплой:** https://amber-family-tree.lovable.app/

---

## Соответствие брифу (Angelo_project_brief.md)

| Блок | Статус |
|------|--------|
| Идея: закрытая семейная сеть, фото/видео/аудио, дерево | ✅ Реализовано в прототипе |
| Платформа: Telegram Mini App, абстракция от SDK (перенос в PWA) | ✅ `PlatformAdapter`, `TelegramAdapter`, `MockWebAdapter` |
| Стиль: magazine-style галерея, тёплые тона | ✅ Палитра, типографика, карточки 60/40 |
| Загрузка контента, лимиты 20/500/100 MB | ✅ Форма создания, проверка размера |
| Gallery, дерево, таймлайн, фильтры | ✅ Лента (публикации/медиа), дерево, сортировка, фильтры |
| AI: STT, стилизация, ассистент, анимация фото | ✅ Страница `/ai` + голосовой помощник на `/app` |
| Регистрация | ⚠️ В брифе — через Telegram; в макете и прототипе — телефон/email + код (UI готов, отправка кода — мок) |
| Legacy Storage | Не в прототипе (фаза исследования по брифу) |

Подробно: [СВЕРКА_С_БРИФОМ.md](./СВЕРКА_С_БРИФОМ.md).

---

## Соответствие экранам ТЗ («Экраны (детально).pdf»)

Все **25 экранов** из ТЗ реализованы.

- **Welcome, Вход, Регистрация, Подтверждение кода, Онбординг** — по ТЗ, тексты и кнопки на месте.
- **Дерево, Лента (публикации и медиа), Фильтры** — в т.ч. автор, участники, даты, избранное, непрочитанное.
- **Публикация (детальная, создание, выбор типа)** — карточки 60/40, лимиты файлов, тег темы.
- **Семья** — вкладки «Обо мне»/«Семья», «Профили»/«Группы», фильтр все/активные/неактивные.
- **Профиль «Я», профиль контакта** — напоминание про ник, ссылки на публикации/медиа с фильтром.
- **Пригласить, Приглашения** — RU, действия по элементу, входящие (принять/отклонить).
- **Подписка, Места, Оплата (успех/ошибка)** — заголовок «Подписка», экран «Места», мок оплаты.
- **Настройки, Помощь** — Профиль, Выйти, Документы (условия/политика), FAQ.

Подробно: [СВЕРКА_ЭКРАНЫ_ДЕТАЛЬНО.md](./СВЕРКА_ЭКРАНЫ_ДЕТАЛЬНО.md).

---

## Что видно и возможно в режиме демо (без регистрации)

- **Главная (Welcome):** логотип Angelo, «твой семейный альбом», кнопки «Войти» / «Создать аккаунт», «Условия / Политика», **«Смотреть демо»**.
- **По нажатию «Смотреть демо»** открывается **голосовой помощник** (`/app`): микрофон, распознавание речи (Web Speech API), ответы по интентам (дерево, персона, лента, семья, магазин, создать публикацию, помощь). При наличии ключа OpenAI локально — озвучка ответов голосом OpenAI TTS.
- Без входа в аккаунт **классический UI** (дерево, лента, семья и т.д.) недоступен — он показывается после «входа» по сценарию (телефон/email → код → онбординг или сразу приложение). Для быстрого просмотра экранов можно пройти мок-вход (например ввести email и «получить код», затем ввести любой код и подтвердить).

---

## Что после регистрации (мок-сценарий входа)

- **Вход / Регистрация / Подтверждение кода** — UI по ТЗ; код не отправляется, любой введённый код ведёт дальше.
- **Онбординг** — «Давайте настроим профиль», поля (фамилия, имя, отчество, дата рождения и т.д.), «Далее» / «Пропустить» → переход в приложение.
- **Классическое приложение** (`/classic/*`): дерево, лента (публикации и медиа), фильтры, детальная публикация, создание публикации, Семья (вкладки Обо мне / Семья, Профили / Группы), профиль «Я», профиль контакта, приглашения, Подписка, Места, Настройки, Помощь. Данные — моки (члены семьи, публикации, приглашения).

---

## Почему локально голос OpenAI, а на Lovable — браузерный

- **Локально (localhost):** В `vite.config.ts` настроен **прокси** запросов `/api/openai` на `api.openai.com`; ключ `VITE_OPENAI_API_KEY` из `.env.local` подставляется на стороне dev-сервера. Фронт дергает `/api/openai/v1/audio/speech` → прокси передаёт запрос в OpenAI → приложение получает аудио и проигрывает **голос OpenAI (TTS)**.
- **На Lovable (деплой):** Сборка **статическая**, без dev-сервера Vite. Прокси из `vite.config.ts` в продакшене **не работает**. Запрос на `/api/openai/...` уходит на хост Lovable, там нет бэкенда, который проксирует в OpenAI, поэтому запрос падает. В коде при ошибке TTS срабатывает **fallback** — озвучка через **браузерный `speechSynthesis`** (системный голос).

**Чтобы на Lovable тоже был голос OpenAI,** нужен бэкенд или serverless-endpoint на стороне Lovable (или внешний прокси), который принимает запросы к `/api/openai` и перенаправляет их в OpenAI с ключом из секретов окружения.
